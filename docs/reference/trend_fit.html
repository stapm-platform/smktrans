<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Statistically model trends in current, former and never smoking — trend_fit • smktrans</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Statistically model trends in current, former and never smoking — trend_fit"><meta name="description" content="Fit a multinomial model to the distribution of people
among current, former and never smoking status
and estimate the variation in trends by sex and socioeconomic conditions in terms of
quintiles of the Index of Multiple Deprivation. The parameterisation of the
statistical model within this function can have a strong effect on the estimated probabilities of
quitting smoking and on the trajectories of smoking prevalence that are forecast using these estimates."><meta property="og:description" content="Fit a multinomial model to the distribution of people
among current, former and never smoking status
and estimate the variation in trends by sex and socioeconomic conditions in terms of
quintiles of the Index of Multiple Deprivation. The parameterisation of the
statistical model within this function can have a strong effect on the estimated probabilities of
quitting smoking and on the trajectories of smoking prevalence that are forecast using these estimates."><meta property="og:image" content="https://stapm-platform.github.io/smktrans/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-167990045-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167990045-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smktrans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/smktrans.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-technical-documentation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Technical documentation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-technical-documentation"><li><a class="dropdown-item" href="../articles/smk_trans_prob_estimation.html">Estimation workflow</a></li>
    <li><a class="dropdown-item" href="../articles/smoking_transition_probabilities_modelling_report.pdf">Methods notes: Smoking state transition probability estimation</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/stapm-platform/smktrans" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Statistically model trends in current, former and never smoking</h1>
      <small class="dont-index">Source: <a href="https://github.com/stapm-platform/smktrans/blob/HEAD/R/trend_fit.R" class="external-link"><code>R/trend_fit.R</code></a></small>
      <div class="d-none name"><code>trend_fit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a multinomial model to the distribution of people
among current, former and never smoking status
and estimate the variation in trends by sex and socioeconomic conditions in terms of
quintiles of the Index of Multiple Deprivation. The parameterisation of the
statistical model within this function can have a strong effect on the estimated probabilities of
quitting smoking and on the trajectories of smoking prevalence that are forecast using these estimates.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trend_fit</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  age_var <span class="op">=</span> <span class="st">"age"</span>,</span>
<span>  year_var <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>  sex_var <span class="op">=</span> <span class="st">"sex"</span>,</span>
<span>  smoker_state_var <span class="op">=</span> <span class="st">"smk.state"</span>,</span>
<span>  imd_var <span class="op">=</span> <span class="st">"imd_quintile"</span>,</span>
<span>  weight_var <span class="op">=</span> <span class="st">"wt_int"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data table containing individual-level survey data over multiple years.</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Integer - the maximum number of iterations to try when looking for the
multinomial model to converge to a stable model fit.</p></dd>


<dt id="arg-age-var">age_var<a class="anchor" aria-label="anchor" href="#arg-age-var"></a></dt>
<dd><p>Character - the name of the variable containing age in single years.</p></dd>


<dt id="arg-year-var">year_var<a class="anchor" aria-label="anchor" href="#arg-year-var"></a></dt>
<dd><p>Character - the name of the variable containing year in single years.</p></dd>


<dt id="arg-sex-var">sex_var<a class="anchor" aria-label="anchor" href="#arg-sex-var"></a></dt>
<dd><p>Character - the name of the variable containing sex (m/f).</p></dd>


<dt id="arg-smoker-state-var">smoker_state_var<a class="anchor" aria-label="anchor" href="#arg-smoker-state-var"></a></dt>
<dd><p>Character - the name of the variable containing smoking status
(current, former, never smoker).</p></dd>


<dt id="arg-imd-var">imd_var<a class="anchor" aria-label="anchor" href="#arg-imd-var"></a></dt>
<dd><p>Character - the name
of the variable containing Index of Multiple Deprivation quintiles.</p></dd>


<dt id="arg-weight-var">weight_var<a class="anchor" aria-label="anchor" href="#arg-weight-var"></a></dt>
<dd><p>Character - the name of the variable containing the survey weights.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a data table containing the fitted values by age, year, sex and IMD quintile.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The explanatory variables for age and year are specified
in the form of a cubic response surface.
An additional 4th order term for age is added to better capture
the non-linear patterns over age e.g.
as individuals initiate and then quit with age.
Interactions of this surface with sex and IMD quintiles
are limited to 3rd order terms. Interactions with the quadratic
term are included for age but not for year
to avoid over-fitting variation in the trend over years,
which is more of a linear change than the pattern over age.
The decision to do so was made after visually exploring the fit of
simpler and more complex model specifications
to the data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu">trend_fit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">hse_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://sheffield.ac.uk/smph/duncan-gillespie" class="external-link">Duncan Gillespie</a>, Laura Webster, Grace Leeming, Magdalena Opazo-Breton, <a href="https://sheffield.ac.uk/smph/people/academic/population-health/alan-brennan" class="external-link">Alan Brennan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

