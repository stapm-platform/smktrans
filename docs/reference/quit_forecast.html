<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Forecast probabilities of smoking initiation, quitting and relapse — quit_forecast • smktrans</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Forecast probabilities of smoking initiation, quitting and relapse — quit_forecast"><meta name="description" content="Forecasts the period trends in the probabilities of smoking initiation, quitting and relapse
by age, sex and IMD quintile. This function was designed originally to forecast just
the probabilities of quitting but has since been extended to forecast initiation and relapse
probabilities too."><meta property="og:description" content="Forecasts the period trends in the probabilities of smoking initiation, quitting and relapse
by age, sex and IMD quintile. This function was designed originally to forecast just
the probabilities of quitting but has since been extended to forecast initiation and relapse
probabilities too."><meta property="og:image" content="https://stapm-platform.github.io/smktrans/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-167990045-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167990045-1');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smktrans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/smktrans.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-technical-documentation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Technical documentation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-technical-documentation"><li><a class="dropdown-item" href="../articles/smk_trans_prob_estimation.html">Estimation workflow</a></li>
    <li><a class="dropdown-item" href="../articles/smoking_transition_probabilities_modelling_report.pdf">Methods notes: Smoking state transition probability estimation</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/stapm-platform/smktrans" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Forecast probabilities of smoking initiation, quitting and relapse</h1>
      <small class="dont-index">Source: <a href="https://github.com/stapm-platform/smktrans/blob/HEAD/R/quit_forecast.R" class="external-link"><code>R/quit_forecast.R</code></a></small>
      <div class="d-none name"><code>quit_forecast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Forecasts the period trends in the probabilities of smoking initiation, quitting and relapse
by age, sex and IMD quintile. This function was designed originally to forecast just
the probabilities of quitting but has since been extended to forecast initiation and relapse
probabilities too.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">quit_forecast</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">forecast_var</span>,</span>
<span>  forecast_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"continuing"</span>, <span class="st">"stationary"</span><span class="op">)</span>,</span>
<span>  cont_limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oldest_year <span class="op">=</span> <span class="fl">2003</span>,</span>
<span>  youngest_age <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  oldest_age <span class="op">=</span> <span class="fl">88</span>,</span>
<span>  age_cont_limit <span class="op">=</span> <span class="fl">88</span>,</span>
<span>  first_year <span class="op">=</span> <span class="fl">2010</span>,</span>
<span>  jump_off_year <span class="op">=</span> <span class="fl">2015</span>,</span>
<span>  time_horizon <span class="op">=</span> <span class="fl">2050</span>,</span>
<span>  smooth_rate_dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  k_smooth_age <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data table containing the probabilities to be forecast.</p></dd>


<dt id="arg-forecast-var">forecast_var<a class="anchor" aria-label="anchor" href="#arg-forecast-var"></a></dt>
<dd><p>Character - the name of the probability variable to be forecast.</p></dd>


<dt id="arg-forecast-type">forecast_type<a class="anchor" aria-label="anchor" href="#arg-forecast-type"></a></dt>
<dd><p>Character - whether to apply the estimated
rates of proportional change ("continuing")
or to keep the forecast variable constant at its last observed value ("stationary").</p></dd>


<dt id="arg-cont-limit">cont_limit<a class="anchor" aria-label="anchor" href="#arg-cont-limit"></a></dt>
<dd><p>Integer - the year at which a continuing forecast becomes stationary.</p></dd>


<dt id="arg-oldest-year">oldest_year<a class="anchor" aria-label="anchor" href="#arg-oldest-year"></a></dt>
<dd><p>Integer - the oldest year of data we have. Default is set to 2003 for England.</p></dd>


<dt id="arg-youngest-age">youngest_age<a class="anchor" aria-label="anchor" href="#arg-youngest-age"></a></dt>
<dd><p>Integer - the youngest age we have in the data.
Default is set to 11 for England.</p></dd>


<dt id="arg-oldest-age">oldest_age<a class="anchor" aria-label="anchor" href="#arg-oldest-age"></a></dt>
<dd><p>Integer - the oldest age we have in the data - set to 88 for quitting and relapse
and 30 for initiation.</p></dd>


<dt id="arg-age-cont-limit">age_cont_limit<a class="anchor" aria-label="anchor" href="#arg-age-cont-limit"></a></dt>
<dd><p>Integer - the age after which the forecast transition probabilities
for a year, sex and IMD quintile are assumed not to change.</p></dd>


<dt id="arg-first-year">first_year<a class="anchor" aria-label="anchor" href="#arg-first-year"></a></dt>
<dd><p>Integer - the earliest year of data on which the forecast is based.</p></dd>


<dt id="arg-jump-off-year">jump_off_year<a class="anchor" aria-label="anchor" href="#arg-jump-off-year"></a></dt>
<dd><p>Integer - the last year of data.</p></dd>


<dt id="arg-time-horizon">time_horizon<a class="anchor" aria-label="anchor" href="#arg-time-horizon"></a></dt>
<dd><p>Integer - the last year of the forecast period.</p></dd>


<dt id="arg-smooth-rate-dim">smooth_rate_dim<a class="anchor" aria-label="anchor" href="#arg-smooth-rate-dim"></a></dt>
<dd><p>Numeric vector length 2. The dimensions of the 2d window used to smooth trends
in the rates by age and year. (age, year), Defaults to c(3, 3). Must be odd numbers.</p></dd>


<dt id="arg-k-smooth-age">k_smooth_age<a class="anchor" aria-label="anchor" href="#arg-k-smooth-age"></a></dt>
<dd><p>Integer - the degree of smoothing to apply to the age pattern of change (rotation).
If zero, then no smoothing is applied.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a data.table containing the observed and forecast data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The forecast is based on applying a Singular value decomposition (SVD)
to the logit transformed matrix of quit probabilities by
age and year for each subgroup.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">forecast_data</span> <span class="op">&lt;-</span> <span class="fu">quit_forecast</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/copy.html" class="external-link">copy</a></span><span class="op">(</span><span class="va">quit_data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  forecast_var <span class="op">=</span> <span class="st">"quit_prob"</span>,</span></span>
<span class="r-in"><span>  forecast_type <span class="op">=</span> <span class="st">"continuing"</span>,</span></span>
<span class="r-in"><span>  first_year <span class="op">=</span> <span class="fl">2010</span>,</span></span>
<span class="r-in"><span>  jump_off_year <span class="op">=</span> <span class="fl">2015</span>,</span></span>
<span class="r-in"><span>  time_horizon <span class="op">=</span> <span class="fl">2030</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://sheffield.ac.uk/smph/duncan-gillespie" class="external-link">Duncan Gillespie</a>, Laura Webster, Grace Leeming, Magdalena Opazo-Breton, <a href="https://sheffield.ac.uk/smph/people/academic/population-health/alan-brennan" class="external-link">Alan Brennan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

