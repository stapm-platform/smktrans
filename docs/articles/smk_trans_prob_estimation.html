<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Workflow for Estimating Smoking Transition Probabilities • smktrans</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Workflow for Estimating Smoking Transition Probabilities">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-167990045-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-167990045-1');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700&amp;display=swap">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smktrans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/smktrans.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><h6 class="dropdown-header" data-toc-skip>Regional Estimates</h6></li>
    <li><a class="dropdown-item" href="../articles/report_england.html">England Report</a></li>
    <li><a class="dropdown-item" href="../articles/report_scotland.html">Scotland Report</a></li>
    <li><a class="dropdown-item" href="../articles/report_wales.html">Wales Report</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Technical documentation</h6></li>
    <li><a class="dropdown-item" href="../articles/smk_trans_prob_estimation.html">Estimation workflow</a></li>
    <li><a class="dropdown-item" href="../articles/smoking_transition_probabilities_modelling_report.pdf">Methods notes: Smoking state transition probability estimation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/stapm-platform/smktrans" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Workflow for Estimating Smoking Transition Probabilities</h1>
            
            <h4 data-toc-skip class="date">February 2026</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/stapm-platform/smktrans/blob/HEAD/vignettes/smk_trans_prob_estimation.Rmd" class="external-link"><code>vignettes/smk_trans_prob_estimation.Rmd</code></a></small>
      <div class="d-none name"><code>smk_trans_prob_estimation.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides a step-by-step guide to estimating the annual
probabilities of smoking initiation, quitting, and relapse using the
<code>smktrans</code> package. These estimates underpin the Sheffield
Tobacco Policy Model (STPM).</p>
<p>The core philosophy of this workflow is <strong>consistency</strong>.
We do not estimate rates in isolation; instead, we use a “Stock and
Flow” approach where the robustly measured number of smokers (the Stock)
is used to solve for the unobservable quit rates (the Flow).</p>
<div class="section level3">
<h3 id="the-workflow-at-a-glance">The Workflow at a Glance<a class="anchor" aria-label="anchor" href="#the-workflow-at-a-glance"></a>
</h3>
<p>The following diagram illustrates how raw survey data is transformed
into a consistent transition matrix.</p>
<p><img src="workflow.png" alt="" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="phase-1-initiation-the-inflow">Phase 1: Initiation (The Inflow)<a class="anchor" aria-label="anchor" href="#phase-1-initiation-the-inflow"></a>
</h2>
<p><strong>Objective:</strong> Estimate the probability of a Never
Smoker becoming a Smoker at age
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>x</mi><annotation encoding="application/x-tex">x</annotation></semantics></math>
in year
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.</p>
<p><strong>The Challenge:</strong> Older people often forget exactly
when they started smoking (“Recall Bias”). Furthermore, differential
mortality means that early initiators are less likely to survive to be
surveyed in older age. Using raw recall data alone would suggest
initiation rates were lower in the past than they actually were.</p>
<p><strong>The Solution:</strong> The <strong>Holford Method</strong>.
We reconstruct histories based on reported starting ages (subject to
bias) and adjust them to match the robust “Ever-Smoker” prevalence
directly observed in each year.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Reconstruct (<code>init_est</code>):</strong> Builds the
“Risk Set” for every cohort using cross-sectional recall.<br>
</li>
<li>
<strong>Target (<code>ever_smoke</code>):</strong> Fits a
Generalized Linear Model (Quasibinomial) to estimate the true proportion
of Ever-Smokers at age 30.<br>
</li>
<li>
<strong>Calibrate (<code>init_adj</code>):</strong> Scales the raw
curves so their cumulative sum matches the targets.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Reconstruct longitudinal histories from cross-sectional recall</span></span>
<span><span class="va">init_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init_est.html">init_est</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  strat_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"imd_quintile"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Estimate the 'Truth': Proportion of ever-smokers at age 25-34</span></span>
<span><span class="co"># We use Model 8 (Sex + IMD + Year_Bin) for a stable target</span></span>
<span><span class="va">target_trends</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ever_smoke.html">ever_smoke</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"model8"</span>, </span>
<span>  age_cats <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"25-34"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Adjust the curves using the Holford method</span></span>
<span><span class="co"># This corrects the recall bias to match the 'truth' at age 30</span></span>
<span><span class="va">init_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/init_adj.html">init_adj</a></span><span class="op">(</span></span>
<span>  init_data <span class="op">=</span> <span class="va">init_raw</span>,</span>
<span>  ever_smoke_data <span class="op">=</span> <span class="va">target_trends</span><span class="op">$</span><span class="va">predicted_values</span>,</span>
<span>  ref_age <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phase-2-relapse-the-reflow">Phase 2: Relapse (The Reflow)<a class="anchor" aria-label="anchor" href="#phase-2-relapse-the-reflow"></a>
</h2>
<p><strong>Objective:</strong> Estimate the probability of a Former
Smoker becoming a Current Smoker.</p>
<p><strong>The Challenge:</strong> Relapse risk depends heavily on
<strong>Time Since Quit (TSQ)</strong>. Most relapse happens in year 1.
However, general cross-sectional surveys rarely capture enough long-term
quitters to estimate late-stage relapse (5+ years post-quit)
reliably.</p>
<p><strong>The Solution:</strong> We combine survey demographics with
clinical evidence (Hawkins et al., 2010) which provides the
<em>shape</em> of the relapse hazard curve.</p>
<ol style="list-style-type: decimal">
<li>
<strong>Map (<code>prep_relapse</code>):</strong> Calculates the
weighted average relapse probability for every Age/Sex/IMD group by
mapping their specific characteristics to the Hawkins hazard
ratios.<br>
</li>
<li>
<strong>Forecast (<code>relapse_forecast</code>):</strong> Projects
the general trend forward and applies it as a scalar to the detailed TSQ
curves.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Map survey demographics to Hawkins' clinical hazard ratios</span></span>
<span><span class="va">relapse_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_relapse.html">prep_relapse</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  hawkins_relapse <span class="op">=</span> <span class="fu">smktrans</span><span class="fu">::</span><span class="va"><a href="../reference/hawkins_relapse.html">hawkins_relapse</a></span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Forecast the trend and apply it to the detailed Time-Since-Quit data</span></span>
<span><span class="co"># Note: relapse_trend_forecast is derived from a preliminary run of quit_forecast</span></span>
<span><span class="va">relapse_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relapse_forecast.html">relapse_forecast</a></span><span class="op">(</span></span>
<span>  relapse_forecast_data <span class="op">=</span> <span class="va">relapse_trend_forecast</span>, </span>
<span>  relapse_by_age_imd_timesincequit <span class="op">=</span> <span class="va">relapse_data</span><span class="op">$</span><span class="va">relapse_by_age_imd_timesincequit</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phase-3-trends-in-current-former-and-never-smoking-the-stock">Phase 3: Trends in Current, Former and Never Smoking (The
Stock)<a class="anchor" aria-label="anchor" href="#phase-3-trends-in-current-former-and-never-smoking-the-stock"></a>
</h2>
<p>Before we can solve for quitting, we need a clear picture of the
“Stock” (Prevalence) and the “Leak” (Mortality).</p>
<div class="section level3">
<h3 id="step-3-1-the-prevalence-map-trend_fit">Step 3.1: The Prevalence Map (<code>trend_fit</code>)<a class="anchor" aria-label="anchor" href="#step-3-1-the-prevalence-map-trend_fit"></a>
</h3>
<p>Raw survey prevalence is noisy. We cannot calculate year-on-year
flows from jagged data. We fit a <strong>Multinomial Response
Surface</strong> to smooth the data over time and age.</p>
<p>The model assumes the log-odds of being in a specific state are a
function of high-order interactions:<br><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>P</mi><mrow><mi>s</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi></mrow></msub><msub><mi>P</mi><mrow><mi>r</mi><mi>e</mi><mi>f</mi></mrow></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mtext mathvariant="normal">Age</mtext><mn>4</mn></msup><mo>,</mo><msup><mtext mathvariant="normal">Year</mtext><mn>3</mn></msup><mo>,</mo><mtext mathvariant="normal">Sex</mtext><mo>,</mo><mtext mathvariant="normal">IMD</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ln\left(\frac{P_{state}}{P_{ref}}\right) = f(\text{Age}^4, \text{Year}^3, \text{Sex}, \text{IMD})</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="step-3-2-differential-mortality-smoke_surv">Step 3.2: Differential Mortality (<code>smoke_surv</code>)<a class="anchor" aria-label="anchor" href="#step-3-2-differential-mortality-smoke_surv"></a>
</h3>
<p>Smokers die faster than non-smokers. If we ignore this, we might
mistake a drop in smoker numbers (due to death) for quitting. We
calculate survival probabilities
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>p</mi><mi>x</mi></msub><annotation encoding="application/x-tex">p_x</annotation></semantics></math>)
specifically for Current, Former, and Never smokers using
disease-specific relative risks.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Fit a smooth surface to the smoking states (Multinomial Model)</span></span>
<span><span class="va">trend_surface</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trend_fit.html">trend_fit</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  smoker_state_var <span class="op">=</span> <span class="st">"smk.state"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2. Calculate survival probabilities by smoking status</span></span>
<span><span class="va">mortality_diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/smoke_surv.html">smoke_surv</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  mx_data <span class="op">=</span> <span class="va">tob_mort_data</span>,</span>
<span>  diseases <span class="op">=</span> <span class="fu">tobalcepi</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/tobalcepi/man/tob_disease_names.html" class="external-link">tob_disease_names</a></span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="phase-4-quitting-the-solver">Phase 4: Quitting (The Solver)<a class="anchor" aria-label="anchor" href="#phase-4-quitting-the-solver"></a>
</h2>
<p><strong>Objective:</strong> Calculate the “Hidden Flow”
(Quitting).</p>
<p><strong>The Logic:</strong><br>
We rely on the demographic balancing equation. We possess the following
knowns:<br>
1. <strong>Stock
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>t</mi></msub><mo>,</mo><msub><mi>N</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">N_t, N_{t+1}</annotation></semantics></math>):</strong>
From <code>trend_fit</code>.<br>
2. <strong>Inflow (Start):</strong> From <code>init_adj</code>.<br>
3. <strong>Reflow (Relapse):</strong> From
<code>prep_relapse</code>.<br>
4. <strong>Death (Survival
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>S</mi><annotation encoding="application/x-tex">S</annotation></semantics></math>):</strong>
From <code>smoke_surv</code>.</p>
<p>We plug these into the <strong>Flow Equation</strong> to solve for
the unknown Quit probability
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>).
The fundamental population balance is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>N</mi><mi>t</mi></msub><mo>×</mo><mi>S</mi><mo>×</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow><mo>+</mo><mtext mathvariant="normal">Inflow</mtext></mrow><annotation encoding="application/x-tex">N_{t+1} = \left[ N_t \times S \times (1 - q) \right] + \text{Inflow}</annotation></semantics></math></p>
<p>Rearranging this to solve for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>q</mi><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><msub><mi>N</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub><mrow><msub><mi>N</mi><mi>t</mi></msub><mo>×</mo><mi>S</mi></mrow></mfrac><mo>+</mo><mfrac><mtext mathvariant="normal">Inflow</mtext><mrow><msub><mi>N</mi><mi>t</mi></msub><mo>×</mo><mi>S</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">q = 1 - \frac{N_{t+1}}{N_t \times S} + \frac{\text{Inflow}}{N_t \times S}</annotation></semantics></math><br><em>Where Inflow includes both Relapse and Initiation.</em></p>
<p>This ensures internal consistency: the calculated quit rates
perfectly reproduce the observed prevalence trends when run forward.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Solve for the unknown variable: Quitting</span></span>
<span><span class="co"># This function balances the stocks and flows</span></span>
<span><span class="va">quit_rates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quit_est.html">quit_est</a></span><span class="op">(</span></span>
<span>  trend_data <span class="op">=</span> <span class="va">trend_surface</span>,</span>
<span>  survivorship_data <span class="op">=</span> <span class="va">survivorship_data</span>,</span>
<span>  mortality_data <span class="op">=</span> <span class="va">mortality_diffs</span><span class="op">$</span><span class="va">data_for_quit_ests</span>,</span>
<span>  relapse_data <span class="op">=</span> <span class="va">relapse_data</span><span class="op">$</span><span class="va">relapse_by_age_imd</span>,</span>
<span>  initiation_data <span class="op">=</span> <span class="va">init_final</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="phase-5-forecasting-the-future">Phase 5: Forecasting the Future<a class="anchor" aria-label="anchor" href="#phase-5-forecasting-the-future"></a>
</h2>
<p><strong>Objective:</strong> Project these rates to 2040 and
beyond.</p>
<p><strong>The Solution:</strong> The <strong>Lee-Carter SVD
Method</strong>.<br>
We employ a Singular Value Decomposition (SVD) approach, commonly used
in mortality forecasting. This allows us to model the logit of the rates
as a linear combination of an age-specific profile and a time-varying
index.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>P</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>α</mi><mi>x</mi></msub><mo>+</mo><msub><mi>β</mi><mi>x</mi></msub><msub><mi>κ</mi><mi>t</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>x</mi><mo>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\text{logit}(P_{x,t}) = \alpha_x + \beta_x \kappa_t + \epsilon_{x,t}</annotation></semantics></math></p>
<p>Where:<br>
*
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\alpha_x</annotation></semantics></math>:</strong>
The average age profile (e.g., quitting peaks at age 30 and 60).<br>
*
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>κ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\kappa_t</annotation></semantics></math>:</strong>
The time trend index (e.g., the general decline or rise in rates over
years).<br>
*
<strong><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>x</mi></msub><annotation encoding="application/x-tex">\beta_x</annotation></semantics></math>:</strong>
The sensitivity of each age group to the time trend.</p>
<p>We project the <em>Trend</em>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>κ</mi><mi>t</mi></msub><annotation encoding="application/x-tex">\kappa_t</annotation></semantics></math>)
forward linearly and recombine it with the <em>Shape</em>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>x</mi></msub><mo>,</mo><msub><mi>β</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_x, \beta_x</annotation></semantics></math>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forecast Quitting</span></span>
<span><span class="va">quit_future</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quit_forecast.html">quit_forecast</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">quit_rates</span>,</span>
<span>  forecast_var <span class="op">=</span> <span class="st">"p_quit"</span>,</span>
<span>  forecast_type <span class="op">=</span> <span class="st">"continuing"</span>,</span>
<span>  time_horizon <span class="op">=</span> <span class="fl">2040</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Forecast Initiation (using the same function)</span></span>
<span><span class="va">init_future</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/quit_forecast.html">quit_forecast</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">init_final</span>,</span>
<span>  forecast_var <span class="op">=</span> <span class="st">"p_start"</span>,</span>
<span>  forecast_type <span class="op">=</span> <span class="st">"continuing"</span>,</span>
<span>  time_horizon <span class="op">=</span> <span class="fl">2040</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://sheffield.ac.uk/smph/duncan-gillespie" class="external-link">Duncan Gillespie</a>, <a href="https://sheffield.ac.uk/smph/people/academic/population-health/alan-brennan" class="external-link">Alan Brennan</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
